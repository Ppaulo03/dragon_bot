{% macro transaction_card(tx, cat_lv1) %}
<article id="tx-card-{{ tx.id }}" class="tx-card" data-tx-id="{{ tx.id }}"
    data-current-cat="{{ tx.category_id or '' }}">

    <div class="tx-card-inner">
        <div class="tx-info-col">
            <div class="tx-top-bar">
                <div class="tx-badges">
                    <span class="badge-account">
                        üè¶ {{ tx.account.name if tx.account else 'Sem Conta' }}
                    </span>
                    <span class="badge-date">
                        {{ tx.date_timestamp | timestamp_to_date }}
                    </span>
                </div>

                <div class="tx-amount {{ 'positive' if tx.amount_cents > 0 else 'negative' }}">
                    R$ {{ "%.2f"|format(tx.amount_cents / 100) }}
                </div>
            </div>

            <div class="tx-details">
                <input type="text" class="inline-edit-entity" value="{{ tx.entity }}"
                    onchange="updateTx('{{ tx.id }}', {entity: this.value})" placeholder="Entidade...">

                <p class="tx-description">
                    <span class="icon">üìù</span> {{ tx.description or "Sem descri√ß√£o" }}
                </p>
            </div>
        </div>

        <div class="tx-action-col">
            <label class="micro-label">Classifica√ß√£o Hier√°rquica</label>

            <div class="classification-selects">
                <select id="lv1-{{ tx.id }}" class="cat-select" data-level="1"
                    onchange="filterLevels('{{ tx.id }}', 1)">
                    <option value="">Raiz</option>
                    {% for c in cat_lv1 %}
                    <option value="{{ c.id }}">{{ c.name }}</option>
                    {% endfor %}
                </select>

                <select id="lv2-{{ tx.id }}" class="cat-select" data-level="2" onchange="filterLevels('{{ tx.id }}', 2)"
                    disabled>
                    <option value="">Grupo</option>
                </select>

                <select id="lv3-{{ tx.id }}" class="cat-select" data-level="3"
                    onchange="updateTx('{{ tx.id }}', {category_id: this.value})" disabled>
                    <option value="">Categoria</option>
                </select>
            </div>

            <div class="tx-status-bar">
                {% if tx.is_category_automatic %}
                <span class="status-badge bot" id="status-{{ tx.id }}">
                    ü§ñ Sugest√£o do Bot
                </span>
                {% else %}
                <span class="status-badge user" id="status-{{ tx.id }}">
                    üë§ Revisado
                </span>
                {% endif %}
            </div>
        </div>
    </div>
</article>
{% endmacro %}